<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>FriendFinder</title>
    <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/css/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="style.css">
</head>

<body>

    <div class="container">
        <h4>Survey Questions</h4>
        <hr>
        <div class="row">
            <form class="col s12">
                <h5>
                    <b>About You</b>
                </h5>
                <div class="input-field">
                    <input id="name" type="text">
                    <label for="name"> Name (Required)</label>
                </div>
                <div class="input-field">
                    <input id="photo" type="text">
                    <label for="photo"> Link to Photo Image (Required)</label>
                </div>
            </form>
        </div>
        <br>
        <div class="carousel carousel-slider center" data-indicators="true">
            <div class="carousel-item blue white-text" href="#one!">
                <div class="container">
                    <br>
                    <h4>
                        <b>Question 1</b>
                    </h4>
                    <p>Your mind is always buzzing with unexplored ideas and plans.</p>
                    <br>
                    <div class="input-field" style="width: 50%; display: block; margin: 0 auto;">
                        <select id="q1">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="carousel-item blue white-text" href="#two!">
                <br>
                <div class="container">
                    <h4>
                        <b>Question 2</b>
                    </h4>
                    <p>Generally speaking, you rely more on your experience than your imagination</p>
                    <br>
                    <div class="input-field" style="width: 50%; display: block; margin: 0 auto;">
                        <select id="q2">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="carousel-item blue white-text" href="#three!">
                <br>
                <div class="container">
                    <h4>
                        <b>Question 3</b>
                    </h4>
                    <p>You find it easy to stay relaxed and focused even when there is some pressure.</p>
                    <br>
                    <div class="input-field" style="width: 50%; display: block; margin: 0 auto;">
                        <select id="q3">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="carousel-item blue white-text" href="#four!">
                <br>
                <div class="container">
                    <h4>
                        <b>Question 4</b>
                    </h4>
                    <p>You rarely do something just out of sheer curiosity.</p>
                    <br>
                    <div class="input-field" style="width: 50%; display: block; margin: 0 auto;">
                        <select id="q4">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="carousel-item blue white-text" href="#one!">
                <br>
                <div class="container">
                    <h4>
                        <b>Question 5</b>
                    </h4>
                    <p>People can rarely upset you.</p>
                    <br>
                    <div class="input-field" style="width: 50%; display: block; margin: 0 auto;">
                        <select id="q5">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="carousel-item blue white-text" href="#one!">
                <br>
                <div class="container">
                    <h4>
                        <b>Question 6</b>
                    </h4>
                    <p>It is often difficult for you to relate to other people’s feelings.</p>
                    <br>
                    <div class="input-field" style="width: 50%; display: block; margin: 0 auto;">
                        <select id="q6">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="carousel-item blue white-text" href="#one!">
                <br>
                <div class="container">
                    <h4>
                        <b>Question 7</b>
                    </h4>
                    <p>In a discussion, truth should be more important than people’s sensitivities.</p>
                    <br>
                    <div class="input-field" style="width: 50%; display: block; margin: 0 auto;">
                        <select id="q7">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="carousel-item blue white-text" href="#one!">
                <br>
                <div class="container">
                    <h4>
                        <b>Question 8</b>
                    </h4>
                    <p>You rarely get carried away by fantasies and ideas.</p>
                    <br>
                    <div class="input-field" style="width: 50%; display: block; margin: 0 auto;">
                        <select id="q8">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="carousel-item blue white-text" href="#one!">
                <br>
                <div class="container">
                    <h4>
                        <b>Question 9</b>
                    </h4>
                    <p>You think that everyone’s views should be respected regardless of whether they are supported by facts
                        or not.
                    </p>
                    <br>
                    <div class="input-field" style="width: 50%; display: block; margin: 0 auto;">
                        <select id="q9">
                            <option value="" disabled selected>Choose your option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="carousel-item blue white-text" href="#one!">
                <br>
                <div class="container">
                    <h4>
                        <b>Question 10</b>
                    </h4>
                    <p>You feel more energetic after spending time with a group of people.</p>
                    <br>
                    <div class="input-field quest" style="width: 50%; display: block; margin: 0 auto;">
                        <select id="q10">
                            <option disabled selected>Choose your option</option>
                            <option value="1"> 1 (Strongly Disagree)</option>
                            <option value="2"> 2</option>
                            <option value="3"> 3</option>
                            <option value="4"> 4</option>
                            <option value="5"> 5 (Strongly Agree)</option>
                        </select>
                    </div>
                </div>
            </div>
        </div>
        <br>

        <button class="btn waves-effect waves-light submit modal-trigger blue" type="submit" href="#modal1" name="action">Submit
            <i class="material-icons right">send</i>
        </button>
        <br>
        <hr>
    </div>

    <footer class="footer">
        <div class="container">
            <p>
                <a href="../api/friends">API Friends</a> |
                <a href="https://github.com/RaMbo8315/friend-finder">GitHub Repo</a>
            </p>
        </div>
    </footer>

    <div id="modal1" class="modal">
        <div class="modal-content container">
            <h4>
                <b>Best Match</b>
            </h4>
            <hr>
            <div class="results"></div>
            <div class="modal-footer">
                <button href="#!" class="btn modal-action modal-close waves-effect waves-light blue">
                    close
                </button>
            </div>
        </div>
    </div>

    </div>
    <script type="text/javascript" src="https://code.jquery.com/jquery-3.2.1.min.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/materialize/0.100.2/js/materialize.min.js"></script>
    <script type="text/javascript">
        $(document).ready(function () {
            $('.carousel.carousel-slider').carousel({
                fullWidth: true
            });
            $('select').material_select();

            var valid = false;
            var quest = [];
            var name = "";
            var photo = "";
            var newFriend = "";

            $(".submit").on("click", (event) => {
                event.preventDefault();
                name = $(`#name`).val().trim();
                photo = $(`#photo`).val().trim();
                quest.push(parseInt(document.getElementById(`q1`).value));
                quest.push(parseInt(document.getElementById(`q2`).value));
                quest.push(parseInt(document.getElementById(`q3`).value));
                quest.push(parseInt(document.getElementById(`q4`).value));
                quest.push(parseInt(document.getElementById(`q5`).value));
                quest.push(parseInt(document.getElementById(`q6`).value));
                quest.push(parseInt(document.getElementById(`q7`).value));
                quest.push(parseInt(document.getElementById(`q8`).value));
                quest.push(parseInt(document.getElementById(`q9`).value));
                quest.push(parseInt(document.getElementById(`q10`).value));
                validateAndAdd(quest, name, photo);
            })

            validateAndAdd = (q, n, p) => {
                for (var i = 0; i < q.length; i++) {
                    if (isNaN(q[i]) || q[i] < 1 || q[i] > 5 || n === "" || p === "") {
                        quest = [];
                        name = "";
                        photo = "";
                    } else {
                        valid = true;
                    }
                }
                if (valid === true) {
                    newFriend = {
                        name: name,
                        photo: photo,
                        scores: quest
                    }
                    quest = [];
                    name = "";
                    photo = "";
                    $.post("/api/friends", newFriend)
                        .then((data) => {
                            $(".results").append(`<h2>${data.name}</h2>`)
                            $(".results").append(`<img src="${data.photo}">`)
                            $(".results").append(`<hr>`)
                        });
                    $('.modal').modal()
                    $('.modal').modal({
                        dismissible: false,
                        opacity: .5,
                        inDuration: 1000,
                        outDuration: 1000,
                        startingTop: '4%',
                        endingTop: '10%',
                    })
                    $(".results").empty()
                } else {
                    Materialize.toast('Please complete the entire Survey!', 2000)
                }
            };
        });
    </script>
</body>

</html>